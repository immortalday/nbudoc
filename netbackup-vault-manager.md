> How-to NetBackup Vault

\/\/ тут написать что делает NBU Vault

![](/assets/Prom-VM-Win10.png)

\/\/ Описываем как создается NBU Vault

1. Выполнить вход в консоль управления **NetBackup Administration Console**2. Перейти в раздел **Vault Management**3. В разделе **Vault Managent** через контекстное меню в правой области экрана выберите **New Vault Robot**, либо выберите иконку ![](/assets/Prom-VM-Win10-2.png).

  ![](/assets/Prom-VM-Win10-1.png)

2. В окне **New Vault Robot** выберите робот в выпадающем списке **Robot number**, в поле **Robot control host** укажите имя \(fqnd\) медиа \(или мастер\) сервера к которому подключено роботизированное ленточное устройство.

  ![](/assets/Prom-VM-Win10-3.png)

  Выберите **OK** для продолжения.

3. После того как **Vault Robot** бужет создан, выберите его и через контекстное меню в правой области экрана выберите пункт **New Vault**, либо выберите иконку ![](/assets/Prom-VM-Win10-8.png).

  ![](/assets/Prom-VM-Win10-5.png)

4. В окне создания **Vault**, в поле **Vault Name** укажите имя создаваемого **Vault**, в поле **Vault vendor** укажите имя \(произвольное, осмысленное\) поставщика хранения.

  ![](/assets/Prom-VM-Win10-6.png)

  В области **When vaulting, use** выберите пунтк **Containers of many media**, в поле **Off-site volume group** укажите имя группы томов, в которую будут перемещаться медиа носители.

  Затем выберите **OK**.

5. После того как Vault будет создан, создается профиль хранилища, для его создания через контекстное меню в правой области экрана выберите пункт **New Profile**, либо выберите иконку ![](/assets/nb7.7.1 .png).

  ![](/assets/Prom-VM-Win10-7.png)

6. В окне создания профиля, в поле **Profile name** укажите имя создаваемого профиля.

  ![](/assets/nb7.7.1 -1.png)

  Затем выберите **OK**.

7. После того как профиль будет создан, будет отображено окно редактирования параметров профиля.

  ![](/assets/nb7.7.1 -2.png)

  В окне настроек профиля доступны следующие вкладки:

  | Вкладка | Описание |
  | --- | --- |
  | Choose Backups | Описывает критерии выбора образов резервных копий |
  | 1. Duplication | Описывает параметры дублирования образов резервных копий |
  | 2. Catalog Backup | Описывает параметры для действий над каталогом NetBackup |
  | 3. Eject | Описывает парамерты извлечения медиа носителей |
  | Reports | Описывает параметры отчетов |

  После того как будут указаны все необходимые параметры выберите **OK** для их сохранения.

  ### Описание параметров вкладок
  
  #### Вкладка Choose Backups
  
  **Поле Backup started**

  Описывает критерии для выбора образа\(ов\) резервных копий. В области **Backup started** укзывается время за которое производится поиск образов резервных копий для выполнения над ними действий.

  **Параметр Attribute**

  Определяет выбор в соответствии со следующими критериями:

  | Критерии Attribue | Описание |
  | --- | --- |
  | Clients | определяет выбор списка клиентов \(явно\) для которых выполнеятся профиль Vault |
  | Backup types | определяет тип резервного копирования \(явно\), для которого \(которых\) выполняется профиль Vault |
  | Media servers | Определеят медиа сервера для которых выполнеятся профиль Vault |
  | Backup policies | определяет политики резервного копирования, для которых выполняется профиль Vault |
  | Shedules | Определяет рассписания резервного копирования \(явно\), для которых выполнеятся профиль Vaut |
  | Retention levels | определяет уровни хранения для которых выполнеятся профиль Vault |

  **Параметр Location**

  Определяет выбор в соответствии со следующими критериями \(в совокупности с Attribute\):

  | Критерии Location | Описание |
  | --- | --- |
  | basic disks | Определяет \(явно\) месторасположение образов резерных копий \(для типа хранилища basic disk\) для профиля Vault |
  | Disk Pools | Определяет \(явно\) месторасположение образов резервных копий \(для типа хранилища Disk Pool\) для профиля Vault |
  | Source volume groups | Определяет \(явно\) место расположение образов резервных копий для группы \(или нескольких групп\) томов \(лента\) |
  | Volume Pools | Определяет \(явно\) месторасположение образов резервных копий в пуле \(пулах\) томов \(лента\) |

  Параметры **Attribute** и **Location** могут быть использованы как по отдельности, так и совместно друг с другом.

  Для изменения параметров, необходимо включить требуемый параметр \(**Attribute** или **Location**\), затем выбрать критерий и выбрать **Change**.

  Пример приведен на изображении ниже:

  ![](/assets/ISIDA-2.png)
  
  В окне выбора критериев для выбранного параметра, можно указать использование всех доступных критериев, выбрав **Include all <критерии>**, либо явно указать необходимые используюя **Add (All)** и **Remove (All)**.
  
  Пример приведен на изображении ниже:
  
  ![](/assets/ISIDA-3.png)
  
  Для сохранения параметров выберите **OK**.
  
  #### Вкладка 1. Duplication
  
  Вкладка **Duplication** определяет правила и параметры дублирования образов резервных копий между устройствами хранения.
  
  ![](/assets/nb7.7.1 dup.png)
  
  Вкладка содержит следующие параметры:
  
  | Параметр | Описание |
  | --- | --- |
  | **Skip the Duplication step** | Определяет, в случае если он выбран, что данный шаг не будет выполнен в профиле Vault |
  | **Source backups reside on** | Определяет расположение образов резервных копий. Диск или ленточный носитеиль и(или) оба типа.<br> **Disk Only** - определяет что только на дисковом хранилище.<br> **Removable media and/or disk** - определяет что диск или ленточный носитель и(или) оба типа.<br> **Nubmer of read drives** - определяет количество приводов, которые могут быть использованы для чтения образов резервных копий. |
  | **Alternate read server** | Определяет альтернативный (не оригинальный) медиа сервер для чтения образов резервных копий. Данный параметр работает только если в окружении есть роботы (или диски) которые являются общими для более чем одного медиа сервера. |
  | **Storage unit** | Определяет логическую единицу хранения которая будет использована для дублирования на нее образа резервной копии. <br><br> Это могут быть: <br> - Media Manager storage unit <br> - disk storage unit <br> - disk staging storage unit <br> - NDMP storage unit|
  | **Write drives** | Определяет количество приводов записи, совпадает с значением **Number of read drives** |
  | **Volume pool** | Определяет том на который будет выполнено дублирование образа резервной копии|
  | **Retention Level** | Опредеяет уровень хранения, например такой же как у оригинальной резервной копии, либо можно выставить произвольный|
  | **Media Owner** | Определяет владельца (медиа сервер / группу медиа серверов) на который выполняется дублирование образа резервной копии.|
  | **Make this copy primary** | Определяет, назначать ли дублированный образ резервной копии как основной образ резервной копии.|
  |**Preserve multiplexing**| Параметр определяет, будет ли сохранено мультиплексирование для образов резервных копий. <br><br> Следует отметить, что мультиплексирование не распространаяется на образы резервных копий которые размещенв на дисковых устройствах хранения. Однако, если источником образов резервных копий выступает ленточное устройство, а целью назначения дисковое устройство, то использование данного параметра определяет что ленточное устройство будет прочитано за один проход, а не несколько.|
  |**Expire original disk backup images after hour(s)**| Определят отрезок времени (в часах), через которое оригинальные образы резервных копий будут считаться "устаревшими". <br><br> Применим только для дисковых устройств хранения.|
  |**Expire original tape backup images after hour(s)**| Определят отрезок времени (в часах), через которое оригинальные образы резервных копий будут считаться "устаревшими". <br><br> Применим только для ленточных устройств хранения.|
  |**Duplicate smaller images first (applies only to disk images)**| Определяет, что сначала будут дублированы образы резервных копий имеющих небольшой размер. <br><br> Применим только для дисковых устройств хранения.|
  
  **Примечание:** Описание **Advanced Configuration** не рассматривается в данной редакции документа.
  
  #### Вкладка 2. Catalog Backup
  
  Вкладка **Catalog Backup** определяет параметры дублирования образов резервных копий каталога NetBackup.
  
  ![](/assets/Prom-VM-Win10-9.png)
  
  Вкладка содержит следующие параметры:
  
  | Параметр | Описание |
  |---|---|
  |**Skip the Catalog Backup step**|Определяет, в случае если он выбран, что данный шаг не будет выполнен в профиле Vault |
  |**Catalog Backup policy**| Определяет существущую политику резервного копирования каталога NetBackup |
  |**Vault catalog backup schedule**| Определяет существующее рассписание резервного копирования каталога NetBackup|
  
  **Примечание:** рассписание для каталога NetBackup типа **Vault Catalog Backup** должно существовать. В случае, когда данные каталога NetBackup не подлежат дублированию, пропустите этот шаг.
  
  #### Вкладка 3. Eject
  
  Вкладка **Eject** определяет параметры извлечения ленточных носителей.
  
  ![](/assets/Prom-VM-Win10-10.png)
  
  Вкладка содержит следующие параметры:
  
  | Параметр | Описание |
  |---|---|
  |**Skip the Eject step**| Определяет, в случае если он выбран, что данный шаг не будет выполнен в профиле Vault|
  |**Off-site volume pools**|Определяет том(а) пула, который(у) будут использоваться как Off-site том (ленточные носители попавшие в этот том, могут быть извлечены). <br> Для того чтобы указать том, выберите **Add**, в окне выбора томов используя **Add (All)** и **Remove (All)** выберите том переместив его в область **Volume pools to include**. Для сохранения выберите **OK** &  |
  |**Eject media from additional (non NetBackup) volume pool(s)**| Определяет тома расположенные в VSM (Veritas Storage Migrator), которые также могут быть извлечены в рамках профиля Vault|
  |**Suspend this session media**|Определяет приостановку медиа носителя после извлечения. <br> **immediately** - определяет что действие выполняется немедленно, после выполнения политики резервного копирования. Обратите внимание, что в этом случае, извлекаемый медиа носитель будет заполнен на объем записанных данных и может быть заполнен не полностью <br> **At time of eject** - определяет отложенное извлечение медиа носителей (вручную). Используйте этот парамерт, если вы хоитите чтобы медиа носители были заполнены полностью перед их извлечением. Данный параметр используется по умолчанию.|
  |**Suspend media for the next session**| Определяет (в днях) приостановку оригинального медиа носителя (до и после). Использование этого параметра возможно только в тех случаях, когда требуется исключить запись не полных (частичных) образов резервных копий на извлекаемый медиа носитель. При этом, не просиходит приостановки медиа носителей на которые пишутся образы резервных копий (оригинальные медиа носители), приостанавливаются  только те медиа носители, которые создаются (используются в) Vault.|
  |**Eject mode**| Определяет параметры извлечения медиа носителей. <br> **immediately** - определяет немедленное извлечение медиа носителей, после выполнения политики резервного копирования. <br> **Deferred eject** - определяет отложенное извлечение медиа носителей.|
  |**Use e-mail address from Robot or Vault Management Properties for eject notification**| Определяет e-mail указанный в параметрах **Vault Management Properties** на который будут отправляться оповещения об операциях извлечения медиа носителей, если этот параметр выбран.<br>В случае, если параметр не выбран, e-mail указывается вручную. |
  |**The ejected media will be moved to the following off-site volume group**| В этом поле отображается имя группы томов Off-site.|
  
  #### Вкладка Reports
  
  Вкладка Reports определяет правила формирования отчетов о выполнении профиля Vault.
  
  ![](/assets/Prom-VM-Win10-11.png)
  
  Вкладка содержит следующие параметры:
  
  |Параметр|Описание|
  |---|---|
  |Report header|Определяет заголовок отчета для профиля Vault.|
  |Use report settings from Vault Manager Properties|Определяет, в случае если параметр используется, что для создания отчета используются параметры определенные в настройках **Vault Manager Properties**|
  |Report mode| Определяет режим создания отчета о выполнении профиля Vault. <Immediate report - опрделеят что отчет будет создан немедленно после выполнения профиля Vault (после выполнения политики резревного копирования)> <br> Deferred reports - определяет отложенное создание отчета о выполнении профиля Vault (при ручном запуске профиля)|
  
8. !
9. !

